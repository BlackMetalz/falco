customRules:
  detect-cat-in-container.yaml: |
    - rule: Terminal Shell with cat Command in Container in Default namespace
      desc: Detect when someone executes a shell in a container and runs `cat`
      condition: >
        evt.type = execve
        and k8s.ns.name = "default"
      output: >
        CRITICAL: Unauthorized cat command executed in a container 
        (user=%user.name uid=%user.uid process=%proc.name
        command=%proc.cmdline container_id=%container.id 
        container_name=%container.name k8s_ns=%k8s.ns.name)
      priority: CRITICAL
      tags: [security, terminal, exec]